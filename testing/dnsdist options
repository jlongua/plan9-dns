-- https://github.com/clayauld/Secure-Adblocking-DNS/blob/master/dnsdist/dnsdist.conf
setMaxTCPConnectionsPerClient(1000)
setMaxTCPQueriesPerConnection(100)
SetDisableECSAction()

-- send ANY queries to abuse pool
function anyQueries(dq)
  if(dq.qtype==DNSQType.ANY)
  then
    return DNSAction.Pool, "abuse"
  else
    return DNSAction.None, ""
  end
end

addAction(AllRule(), LuaAction(anyQueries))
